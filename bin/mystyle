#!/bin/bash
files=$@
if [[ $files == "" ]] ; then
    files=`find * -name '*.?pp'`
fi

astyle --style=java --add-brackets --lineend=linux --align-pointer=type \
    --align-reference=type \
    --delete-empty-lines --convert-tabs --pad-header --pad-oper --unpad-paren \
    --indent-col1-comments \
    --quiet $files
sed '/^$/N;/^\n$/D' -i $files
sed '/\(FOREACH\)/s/\(\w\) \([*&]\)/\1\2/' -i $files
sed '/define/!s/\(FOREACH\)(/\1 (/' -i $files
sed '$s@\(.\+\)@\1\n@g' -i $files

